<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Admin Daftar Harga Minuman</title>

<!-- BOOTSTRAP -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

<!-- PDF LIBRARY -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.29/jspdf.plugin.autotable.min.js"></script>

<style>
body{background:#f4f6f8}
.card{border-radius:12px}
th{cursor:pointer}
</style>
</head>
<body>

<div class="container mt-5">

<!-- LOGIN -->
<div id="loginBox" class="row justify-content-center">
  <div class="col-md-4">
    <div class="card p-4 shadow">
      <h4 class="text-center mb-3">Login Admin</h4>
      <input id="user" class="form-control mb-2" placeholder="Username">
      <input id="pass" type="password" class="form-control mb-3" placeholder="Password">
      <button class="btn btn-primary w-100" onclick="login()">Login</button>
    </div>
  </div>
</div>

<!-- DASHBOARD -->
<div id="dashboard" style="display:none">

  <div class="d-flex justify-content-between align-items-center mb-3">
    <h3>Dashboard Harga Minuman</h3>
    <button class="btn btn-danger" onclick="logout()">Logout</button>
  </div>

  <!-- INFO HARGA -->
  <div class="row mb-3">
    <div class="col-md-6">
      <div class="alert alert-success">
        üí∞ Harga Termurah: <strong id="minHarga">-</strong>
      </div>
    </div>
    <div class="col-md-6">
      <div class="alert alert-danger">
        üî• Harga Termahal: <strong id="maxHarga">-</strong>
      </div>
    </div>
  </div>

  <!-- FORM -->
  <div class="card p-3 mb-3 shadow">
    <div class="row g-2">
      <div class="col">
        <input id="nama" class="form-control" placeholder="Nama Barang">
      </div>
      <div class="col">
        <input id="harga" type="number" class="form-control" placeholder="Harga">
      </div>
      <div class="col-auto">
        <button class="btn btn-success" onclick="add()">Tambah</button>
      </div>
    </div>
  </div>

  <div class="d-flex gap-2 mb-3">
    <input id="search" class="form-control" placeholder="Cari..." onkeyup="render()">
    <button class="btn btn-secondary" onclick="exportPDF()">üñ®Ô∏è PDF</button>
  </div>

  <table class="table table-striped shadow">
    <thead class="table-dark">
      <tr>
        <th>No</th>
        <th>Nama</th>
        <th onclick="sortHarga()">Harga ‚¨ç</th>
        <th>Aksi</th>
      </tr>
    </thead>
    <tbody id="tbody"></tbody>
  </table>

</div>
</div>

<script>
/* ===== AUTH ===== */
const ADMIN={user:'Santika Jaya',pass:'Santika1'};

function login(){
  if(user.value===ADMIN.user && pass.value===ADMIN.pass){
    localStorage.setItem('login','1');
    showDashboard();
  } else alert('Login gagal');
}
function logout(){
  localStorage.removeItem('login');
  location.reload();
}
function showDashboard(){
  loginBox.style.display='none';
  dashboard.style.display='block';
}

/* ===== DATA ===== */
let data = JSON.parse(localStorage.getItem('data')) || [
  {nama:'INTISARI',harga:48000 + 2000},
  {nama:'ANGKER',harga:37000},
  {nama:'BIR BINTANG',harga:43000},
  {nama:'ROOT BEER',harga:10000},
  {nama:'COCA-COLA',harga:5000},
  {nama:'SPRITE',harga:5000},
  {nama:'FANTA',harga:5000},
  {nama:'ANGGUR MERAH',harga:62000 + 2000}, 
];

let asc=true;

function save(){
  localStorage.setItem('data',JSON.stringify(data));
}

function updateMinMax(){
  if(data.length===0){
    minHarga.innerText='-';
    maxHarga.innerText='-';
    return;
  }
  const prices=data.map(d=>d.harga);
  minHarga.innerText='Rp '+Math.min(...prices).toLocaleString('id-ID');
  maxHarga.innerText='Rp '+Math.max(...prices).toLocaleString('id-ID');
}

function render(){
  tbody.innerHTML='';
  const f=search.value.toUpperCase();
  data.forEach((d,i)=>{
    if(!d.nama.toUpperCase().includes(f)) return;
    tbody.innerHTML+=`
    <tr>
      <td>${i+1}</td>
      <td>${d.nama}</td>
      <td>${d.harga.toLocaleString()}</td>
      <td>
        <button class="btn btn-warning btn-sm" onclick="edit(${i})">Edit</button>
        <button class="btn btn-danger btn-sm" onclick="del(${i})">Hapus</button>
      </td>
    </tr>`;
  });
  updateMinMax();
}

function add(){
  if(!nama.value||!harga.value) return alert('Lengkapi data');
  data.push({nama:nama.value,harga:+harga.value});
  save(); render();
  nama.value=''; harga.value='';
}

function edit(i){
  const n=prompt('Edit Nama',data[i].nama);
  const h=prompt('Edit Harga',data[i].harga);
  if(n&&h){
    data[i]={nama:n,harga:+h};
    save(); render();
  }
}

function del(i){
  if(confirm('Hapus data?')){
    data.splice(i,1);
    save(); render();
  }
}

function sortHarga(){
  data.sort((a,b)=>asc?a.harga-b.harga:b.harga-a.harga);
  asc=!asc; render();
}

/* ===== EXPORT PDF ===== */
function exportPDF(){
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();

  doc.setFontSize(16);
  doc.text('Daftar Harga Minuman', 14, 15);

  const rows = data.map((d,i)=>[
    i+1,
    d.nama,
    'Rp ' + d.harga.toLocaleString('id-ID')
  ]);

  doc.autoTable({
    head: [['No','Nama Barang','Harga']],
    body: rows,
    startY: 25,
    styles:{fontSize:10}
  });

  doc.save('daftar-harga-minuman.pdf');
}

/* ===== INIT ===== */
if(localStorage.getItem('login')) showDashboard();
render();
</script>

</body>
</html>
